{"filter":false,"title":"homepage.js","tooltip":"/homepage.js","undoManager":{"mark":1,"position":1,"stack":[[{"group":"doc","deltas":[{"start":{"row":0,"column":0},"end":{"row":48,"column":1},"action":"insert","lines":["window.onload=function(){","\tdocument.getElementById(\"Compose\").onclick= compose_message;","}","","","function compose_message(){","\tconsole.log(\"The on click works\");","\tvar compose_panel=[","\t\t'<div id =\"compose_window\">',","\t\t'<div id=\"new_message\">',","\t\t'<div id=\"header\"><strong> New Message </strong></div>',","\t\t'</div>',","\t\t'<form>',","\t\t'<fieldset>',","\t\t'<strong>To</strong><br> <input type=\"text\" id =\"recipient\" name=\"recipient\" class=\"textfield\"> <br>',","\t\t'<strong>Subject</strong><br> <input type=\"text\" id=\"subject\" name=\"subject\" class=\"textfield\"> <br><br>',","\t\t'<strong>Message</strong><br> <textarea  id = \"message_content\" name=\"message_content\" cols=\"40\" rows=\"5\"></textarea> <br>',","\t\t'<button id=\"Send\"> <strong> Send </strong> </button>',","\t\t'</fieldset>',","\t\t'</form>',","\t\t'</div>',","\t\t'<div id=\"Response\"></div>',","\t\t","\t].join('');","\tdocument.getElementById(\"pagecontent\").innerHTML= compose_panel;","\tdocument.getElementById(\"Send\").onclick= insert_data;","\t","}","","function insert_data(){","    var rec = document.getElementById(\"recipient\").value;","    var sub = document.getElementById(\"subject\").value;","    var bod = document.getElementById(\"message_content\").value;","    var req_mes = \"message.php?recipient=\"+rec+\"&subject=\"+sub+\"&body=\"+bod;","    var xmlHttp = new XMLHttpRequest();","    xmlHttp.onreadystatechange = function(){","        if(xmlHttp.readyState==4 && xmlHttp.status==200){","            var responseMessage = xmlHttp.responseText;","            document.getElementById(\"Response\").innerHTML= responseMessage;","            alert(responseMessage);","            ","        }","    };","    ","    xmlHttp.open(\"POST\",req_mes,true);","    xmlHttp.send();","    //var responseMessage = xmlHttp.responseText;","    //alert(responseMessage);","}"]}]}],[{"group":"doc","deltas":[{"start":{"row":0,"column":0},"end":{"row":48,"column":1},"action":"remove","lines":["window.onload=function(){","\tdocument.getElementById(\"Compose\").onclick= compose_message;","}","","","function compose_message(){","\tconsole.log(\"The on click works\");","\tvar compose_panel=[","\t\t'<div id =\"compose_window\">',","\t\t'<div id=\"new_message\">',","\t\t'<div id=\"header\"><strong> New Message </strong></div>',","\t\t'</div>',","\t\t'<form>',","\t\t'<fieldset>',","\t\t'<strong>To</strong><br> <input type=\"text\" id =\"recipient\" name=\"recipient\" class=\"textfield\"> <br>',","\t\t'<strong>Subject</strong><br> <input type=\"text\" id=\"subject\" name=\"subject\" class=\"textfield\"> <br><br>',","\t\t'<strong>Message</strong><br> <textarea  id = \"message_content\" name=\"message_content\" cols=\"40\" rows=\"5\"></textarea> <br>',","\t\t'<button id=\"Send\"> <strong> Send </strong> </button>',","\t\t'</fieldset>',","\t\t'</form>',","\t\t'</div>',","\t\t'<div id=\"Response\"></div>',","\t\t","\t].join('');","\tdocument.getElementById(\"pagecontent\").innerHTML= compose_panel;","\tdocument.getElementById(\"Send\").onclick= insert_data;","\t","}","","function insert_data(){","    var rec = document.getElementById(\"recipient\").value;","    var sub = document.getElementById(\"subject\").value;","    var bod = document.getElementById(\"message_content\").value;","    var req_mes = \"message.php?recipient=\"+rec+\"&subject=\"+sub+\"&body=\"+bod;","    var xmlHttp = new XMLHttpRequest();","    xmlHttp.onreadystatechange = function(){","        if(xmlHttp.readyState==4 && xmlHttp.status==200){","            var responseMessage = xmlHttp.responseText;","            document.getElementById(\"Response\").innerHTML= responseMessage;","            alert(responseMessage);","            ","        }","    };","    ","    xmlHttp.open(\"POST\",req_mes,true);","    xmlHttp.send();","    //var responseMessage = xmlHttp.responseText;","    //alert(responseMessage);","}"]},{"start":{"row":0,"column":0},"end":{"row":294,"column":1},"action":"insert","lines":["window.onload = function(){","","\t$(\"logout\").addEventListener(\"click\", destroy);","\t$(\"compose\").addEventListener(\"click\", composemail);","\t$(\"inbox\").addEventListener(\"click\", messages);","\t$(\"home\").addEventListener(\"click\", homescreen);","\t$(\"sentmessage\").addEventListener(\"click\", sentmessages);","\t","\thomescreen();","\t","\t$(\"cuser\").addEventListener(\"click\", create);","\t$('loginbutton').addEventListener(\"click\", valid);","","}","","var homescreen = function(){","\t\tvar me = readCookie(\"user_id\");","\t\tquery = 'recentmessages.php?me='+ me;","\t\t//var myAjax = new Ajax.Updater('id_of_a_hidden_div', 'compose.html', {method: 'get'});"," \t","\t\tvar myAjax2 = new Ajax.Updater('content', query, {method: 'get'});","\t\t\t//$(\"id_of_a_hidden_div\").show();","","\t\t\tAjax.Responders.register({","    ","    onComplete: function() {","      $$('.messagethread').each(function(element) {","  \t\telement.observe(\"click\", function(){","\t\t\t\t$(\"content\").innerHTML = this.innerHTML;","  \t\t\t\tvar messageid = this.id;","  \t\t\t\tquery1 = 'read.php?messageid='+ messageid;","  \t\t\t\tvar myAjax1 = new Ajax.Updater('content', query1, {method: 'get'});","\t\t\t\tquery = 'readmessages.php?messageid='+ messageid+'&me='+me;","\t\t\t\tvar myAjax = new Ajax.Updater('id_of_a_hidden_div', query, {method: 'get'});","","","  \t\t\t\t\t});","    \t});","      $(\"replybutton\").addEventListener(\"click\", composereply);","\t\t\t}","\t});","}","","var composereply = function(){","\t//alert(\"sending message\");","\tvar readfrom = $(\"readfrom\").innerHTML;","\tvar readsubject = \"RE: \"+ $(\"readsubject\").innerHTML;","\tvar readbody = \"'\"+$(\"readbody\").innerHTML+\"'\";","\tvar myAjax = new Ajax.Updater('content', 'compose.html', {method: 'get'});"," \t//to.value = "," \t//","      ",""," \tAjax.Responders.register({","    ","    onComplete: function() {","    \t $(\"to\").removeClassName(\"placeholder\");","    \t $(\"subject\").removeClassName(\"placeholder\");","   \t$(\"subject\").value = readsubject;","      $(\"to\").value = readfrom +\";\";","      $(\"message\").value = readybody;","      var sender = $('sendbutton');","      sender.addEventListener(\"click\", sendmail);","      ","    }","\t\t});","\t//$(\"messageform\").addEventListener(\"mouseover\", function(){alert(\"over messageform\");});","}\t","","","","var messages = function(){","\t\tvar me = readCookie(\"user_id\");","\t\tquery = 'messages.php?me='+ me;","\t\tvar myAjax = new Ajax.Updater('content', query, {method: 'get'});","\t\t","\t\t\tAjax.Responders.register({","    ","    onComplete: function() {","      $$('.messagethread').each(function(element) {","  \t\telement.observe(\"click\", function(){","  \t\t\t\tvar messageid = this.id;","\t\t\t\tquery1 = 'read.php?messageid='+ messageid;","  \t\t\t\tvar myAjax1 = new Ajax.Updater('content', query1, {method: 'get'});","\t\t\t\tquery = 'readmessages.php?messageid='+ messageid+'&me='+me;","\t\t\t\tvar myAjax = new Ajax.Updater('id_of_a_hidden_div', query, {method: 'get'});","  \t\t\t\t\t});","    \t});","\t\t\t}","\t});","","\t","","}","","var sentmessages = function(){","\t\tvar me = readCookie(\"user_id\");","\t\tquery = 'sentmessage.php?me='+ me;","\t\tvar myAjax = new Ajax.Updater('content', query, {method: 'get'});","","}","","function readCookie(name) {","\tvar nameEQ = name + \"=\";","\tvar ca = document.cookie.split(';');","\tfor(var i=0;i < ca.length;i++) {","\t\tvar c = ca[i];","\t\twhile (c.charAt(0)==' ') c = c.substring(1,c.length);","\t\tif (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);","\t}","\treturn null;","}","","var create = function(){","\tvar myAjax = new Ajax.Updater('content', 'createuser.html', {method: 'get'});","\t//alert(\"button working i know that for sure\");","\tAjax.Responders.register({","    ","    onComplete: function() {","      $(\"createbutton\").addEventListener(\"click\", creator);","    }","\t\t});","}","","var creator = function(){","\t//alert(\"you pressed create\");","\t\tif ($('newid').value == \"\" && $('newusername').value == \"\" &&  $('newpassword').value == \"\" && $('newfname').value == \"\"","\t\t\t&& $('newlname').value == \"\"){","\t\t\t\t\t$('error_message').innerHTML = \"Please enter the details above.\";","\t\t\t\terror(newid); error(newusername); error(newpassword); error(newfname); error(newlname);","\t\t}","\t\telse{","","\t\t\t$('error_message').innerHTML = \"\";","\t\t\tif ($('newusername').value == \"\"){","\t\t\t\t$('error_message').innerHTML += \"Please enter username.<br>\";","\t\t\t\terror(newusername);","\t\t\t\t}","","\t\t\tvar icaps = new RegExp(/[a-zA-Z]/);\t","\t\t\tvar inums = new RegExp(/\\d/);","","\t\t\tif ($('newpassword').value == \"\" || !(icaps.test($('newpassword').value)) ||","!(inums.test($('newpassword').value)) || ($('newpassword').value).length < 8 ){","\t\t\t\t$('error_message').innerHTML += \"Please enter a (correct) password.<br>\";","\t\t\t\terror(newpassword);","\t\t\t\t}","\t\t\tif ($('newfname').value == \"\"){","\t\t\t\t$('error_message').innerHTML += \"Please enter first name.<br>\";","\t\t\t\terror(newfname);","\t\t\t\t}","\t\t\tif ($('newlname').value == \"\"){","\t\t\t\t$('error_message').innerHTML += \"Please enter last name.<br>\";","\t\t\t\terror(newlname);","\t\t\t\t}","\t\t\tif ($('newid').value == \"\"){","\t\t\t\t$('error_message').innerHTML += \"Please enter (correct) user id.<br>\";","\t\t\t\terror(newid);","\t\t\t\t}","","\t\t}","\t\t","\tvar illegal = new RegExp(/[-!$%#@^&*()+|~=`{}\\[\\]:\";'<>?,.\\/]/);","\t\tif (illegal.test($('newusername').value)){","\t\t\t$('error_message').innerHTML += \"Invalid username. Please do not add any symbols. <br>\";","\t\t\t$('newusername').focus(); ","\t\t\tremove_error(newpassword);","\t\t\tremove_error(newid);","\t\t\tremove_error(newfname);","\t\t\tremove_error(newlname);","\t\t\terror(newusername);","\t\t}",""," if (isNaN($(\"newid\").value)){","\t\t$('error_message').innerHTML += \"Please enter only numbers into user id.<br>\";","\t\terror(newid);","\t}","","\t\tvar newid = $('newid').value;","\t\tvar newusername = $('newusername').value;","\t\tvar newpassword = $('newpassword').value;","\t\tvar newfname = $('newfname').value;","\t\tvar newlname = $('newlname').value;","\t\t","\t\tif ($(\"adminradio\").checked){","\t\t\tvar type = \"admin\";","\t\t\t//alert(\"admin checked\");","\t\t} else if ($(\"userradio\").checked){","\t\t\tvar type = \"user\";","\t\t\t//alert(\"user taken\");","\t\t}","\t\tquery = 'creator.php?&newid='+newid+'&newusername='+newusername+'&newpassword='+newpassword","\t\t\t+'&newfname='+newfname+'&newlname='+newlname+'&type='+type;","\t\tvar myAjax = new Ajax.Updater(\"create_user\", query, {method: 'get'});","\t","}","","var destroy = function(){","\tdocument.cookie = \"user=;expires=Thu, 01 Jan 1970 00:00:00 GMT\";","\tdocument.cookie = \"user_id=;expires=Thu, 01 Jan 1970 00:00:00 GMT\";","\tdocument.cookie = \"first=;expires=Thu, 01 Jan 1970 00:00:00 GMT\";","\tdocument.cookie = \"usertype=;expires=Thu, 01 Jan 1970 00:00:00 GMT\";","    var myAjax = new Ajax.Updater('content', \"logout.php\", {method: 'get'});","","    window.location.replace(\"cheapomail.html\");","}","","var valid = function(){","\tif ($('username').value == \"\" || $('password').value == \"\"){","\t\t\t$('error_message').innerHTML = \"Please enter username and password.\";","\t\t\t$('login').style.height = \"260px\";","\t\t\terror(username);","\t\t\terror(password);","\t}","\tvar illegal = new RegExp(/[-!$%#@^&*()+|~=`{}\\[\\]:\";'<>?,.\\/]/);","\t\tif (illegal.test($('username').value)){","\t\t\t$('error_message').innerHTML = \"Invalid username. Please do not add any symbols.\";","\t\t\t$('login').style.height = \"260px\";","\t\t\t$('username').focus(); ","\t\t\tremove_error(password);","\t\t\terror(username);","\t\t}","\telse {","\t\tvar username = $('username').value;","\t\tvar password = $('password').value;","\t\tquery = 'inbox.php?&username='+username+'&password='+password;","\t\tvar myAjax = new Ajax.Updater('log', query, {method: 'get'});","\t}","}","","var sendmail = function(){","\t\tvar mess = $(\"message\").value;","\t\tvar t = $(\"to\").value;","\t\tvar sub = $(\"subject\").value;","\t\tvar sender = readCookie(\"user_id\");","\t\tquery = 'send.php?&message='+mess+'&to='+t+'&subject='+sub+'&user_id='+sender;","\t\tvar myAjax = new Ajax.Updater(\"messageform\", query, {method: 'get'});","","}","","var composemail = function(){","\t//alert(\"sending message\");","  ","","\tvar myAjax = new Ajax.Updater('content', 'compose.html', {method: 'get'});"," ",""," \tAjax.Responders.register({","   ","    onComplete: function() {","    \t$(\"subject\").value = \"Add Subject...\";","    \t$(\"to\").value = \"Add Recipient...\";","    \t$(\"message\").value = \"\";","    \t","     \t","      var sender = $('sendbutton');","      sender.addEventListener(\"click\", sendmail);","      $(\"subject\").addEventListener(\"click\", placeholder);","      $(\"to\").addEventListener(\"click\", placeholder1); ","    }","\t\t});","\t//$(\"messageform\").addEventListener(\"mouseover\", function(){alert(\"over messageform\");});","}","","var placeholder = function(){","\tif ($(\"subject\").value == \"Add Subject...\"){","\t$(\"subject\").removeClassName(\"placeholder\");","\t$(\"subject\").value = \"\";","\t\tif ($(\"to\").value == \"\")\t{","\t\t$(\"to\").addClassName(\"placeholder\");","\t\t$(\"to\").value = \"Add Recipient...\";","}","\t}","}","","var placeholder1 = function(){","","\tif ($(\"to\").value == \"Add Recipient...\")\t{","\t\t$(\"to\").removeClassName(\"placeholder\");","\t\t$(\"to\").value = \"\";","\t\tif ($(\"subject\").value == \"\"){","\t\t$(\"subject\").addClassName(\"placeholder\");","\t\t$(\"subject\").value = \"Add Subject...\";","\t}","}","","}","","var error = function(id){","\tid.style.border = \"2px solid red\";","}","","var remove_error = function(id){","\tid.style.border = \"1px solid #B6B6BF\";","}"]}]}]]},"ace":{"folds":[],"scrolltop":3680,"scrollleft":0,"selection":{"start":{"row":294,"column":1},"end":{"row":294,"column":1},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":261,"state":"start","mode":"ace/mode/javascript"}},"timestamp":1417983462883,"hash":"aca2d0d28ddac66a8da62508900ccfab1b492652"}